---
title: "Predicting wine quality based on physicochemical attributes"
author: "Zhihao Xie, Natalie Trusdell, Oswin Gan & Sam Lokanc"
date: "2025/12/06"
jupyter: python3
format: 
    html:
        toc: true
        toc-depth: 2
    pdf:
        toc: true
        toc-depth: 2
bibliography: references.bib
execute:
  echo: false
  warning: false
editor: source
---

# Introduction

Quality assessment is an essential step in the wine making process as it helps ensure consistency and consumer satisfaction. The quality of wine has historically been evaluated by wine makers and sommeliers, who leverage their training and expertise to determine if a product meets acceptable standards @langstaff2010sensory. While there have been advancements in the detection of the physicochemical properties of wine and how they relate to flavour @polavskova2008wine, quality assessment remains a subjective metric.

Here we ask if wine quality can be predicted using machine learning. Our focus is to create an interpretable linear regression model trained on physicochemical wine data to perform this task. The utility of such a model is two-fold as it can be used as a tool to help less experienced wine makers and sommeliers get a sense of the quality of a given wine. Furthermore, the model would help to provide a more objective framework for wine assessment through interpretation of its coefficients. To achieve this, we will train our model on data related to vinho verde white wines from the Minho region of Portugal which contains the physicochemical and sensory data of 4898 wines @cortez2009modeling.

# Methods

## Data

The data was obtained from the UC Irvine Machine Learning Repository @Dua2019. The dataset contains physicochemical and sensory data related to 4898 white wines @cortez2009modeling. The physicochemical data include: fixed acidity, volatile acidity, citric acid, residual sugar, chlorides, free sulfur dioxide, total sulfur dioxide, density, pH, alcohol, and sulfates. These physicochemical data are emperically measured and will be used as features for our predictive model. The sensory data contained in the data set refers to the quality of the wine, which was subjectively measured by wine experts and represented as a score out of ten. This will be the target of our predictive model.

The distributions of the features can be seen in @fig-feature-dist. By taking a look at the individual distributions of the variables, we can see that the majority of them are approximately normal with some degree of right-skew. This tells us that most of the values tend to cluster around the average, possibly an industry standard, with the more extreme values tending to fall above the average rather than below it. The distributions of residual sugar and alcohol content break this pattern as the residual sugar plot follows a more exponential pattern, and the distribution of alcohol content is still approximately normal but also shows a tendency towards uniformity.

::: {#fig-feature-dist layout-ncol=3}

![Fixed Acidity](../results/figures/feature_fixed_acidity_dist.png){#fig-fixed-acidity}

![Volatile Acidity](../results/figures/feature_volatile_acidity_dist.png){#fig-volatile-acidity}

![Citric Acid](../results/figures/feature_citric_acid_dist.png){#fig-citric-acid}

![Residual Sugar](../results/figures/feature_residual_sugar_dist.png){#fig-residual-sugar}

![Chlorides](../results/figures/feature_chlorides_dist.png){#fig-chlorides}

![Free Sulfur Dioxide](../results/figures/feature_free_sulfur_dioxide_dist.png){#fig-free-SO2}

![Total Sulfur Dioxide](../results/figures/feature_total_sulfur_dioxide_dist.png){#fig-total-SO2}

![Density](../results/figures/feature_density_dist.png){#fig-density}

![pH](../results/figures/feature_pH_dist.png){#fig-ph}

![Alcohol](../results/figures/feature_alcohol_dist.png){#fig-alcohol}

![Sulphates](../results/figures/feature_sulphates_dist.png){#fig-sulphates}

Physicochemical Feature Distributions
:::

## Analysis

```{python}
#| echo: false
import pandas as pd

with open("../results/tables/ols_metrics.csv", "r") as f:
    results = pd.read_csv(f)

    r2_ols = results['Value'].iloc[0]
```

For exploratory purposes, we first create an ordinary least squares linear regression model including all predictors:

![OLS Regression Results](../results/tables/ols_summary.html){#fig-ols-results}

This model (@fig-ols-results) has an R-squared value of `{python} f"{r2_ols:.3f}"`, meaning that the model explains roughly `{python} f"{r2_ols:.1%}"` of variability in the data. The R-squared value is close to that of the adjusted R-squared, suggesting most predictors contribute explanatory power to the model. The p-value of the F-statistics is small, indicating that at least one predictor has a statistically significant assocation with the response. The output reveals that the condition number of the model is large, possibly indicating strong multicollinearity. Thus, we will opt for a Ridge Regression to induce an L2 penalty on correlated variables.

::: {#tbl-ridge-results layout-ncol=2}
```{python}
#| echo: false
#| label: tbl-coefficients
#| tbl-cap: "Ridge Features and Coefficients"
import pandas as pd
coef = pd.read_csv("../results/tables/ridge_coefficients.csv")
print(coef.to_markdown(index=False))
```
```{python}
#| echo: false
#| label: tbl-metrics
#| tbl-cap: "Ridge Regression Results"
import pandas as pd
metrics = pd.read_csv("../results/tables/ridge_metrics.csv")
print(metrics.to_markdown(index=False))
```

Ridge Regression Analysis Results
:::

# Results and Discussion
::: {#fig-feature-dist layout-ncol=2}

![Scatterplot of Actual versus Predicted Quality Scores](../results/figures/Actual_vs_Predicted_scatter.png){#fig-scatter}

![Barplot of Actual versus Predicted Quality Scores](../results/figures/Actual_vs_Predicted_boxplot.png){#fig-boxplot}

:::
When we look at the plot for actual versus predicted quality (@fig-scatter), we can see that our model had a tendency to predict the middling quality ratings, suggesting the model was biased by the high frequency of quality ratings of 5-7 in our data. While our ridge regression model did tend to predict higher quality values when the actual quality value was higher, the average prediction stayed between ~5 and 6.5 for all actual quality values.

After running our ridge regression analysis, the variables that the model found most informative for predicting the quality rating were the residual sugar and alcohol content (@tbl-ridge-results), with a higher value of either being correlated on average with a higher predicted quality rating. Intuitively this makes sense, as wines with a higher alcohol content are considered to have more body and a richer taste, but there is also a tradeoff between alcohol content and residual sugar (@copestake2025alcohol). The tradeoff was hinted at in our earlier EDA, as a higher alcohol content was associated with a lower residual sugar content. The alcohol content in wines is derived from a longer fermentation process, but this fermentation also consumes more of the sugar, so it's difficult to attain high levels of both.

These findings indicate that although taste is subjective, tasters have a tendency to prefer white wines that maximize the residual sugar and alcohol content, resulting in a full-bodied wine that is not too dry. Going forward, this could prompt winemakers to experiment with grapes with a higher sugar content and fermentation techniques that try to maximize the alcohol content while minimizing the sugar consumed during the process. This also leads us to questions about how aware sommeliers are of their preferences while judging the quality of wine and how closely the quality rating matches the average wine consumer's preferences. Do sommeliers just tend to enjoy sweeter, full-bodied wines, or is that their personal opinion due to their experience? More research could be done into this topic.

# References
